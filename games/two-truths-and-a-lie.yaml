declaration:
  description: 'A conversational party game of Two Truths and a Lie. Players take
    turns as the speaker, sharing three statements about themselves (two true, one
    false). Others discuss naturally and vote on which statement is the lie; the orchestrator
    interprets dialogue. Points: +1 for each correct guess; when speaking, +1 per
    player fooled. Game ends after each player has been speaker for the agreed number
    of rounds.'
  is_multiplayer: true
  min_players: 3
  player_states:
    name:
      type: string
      example: Alex
      description: Player's display name; public to all players.
    is_speaker:
      type: boolean
      example: true
      description: Whether this player is the current speaker; controls access to
        statement submission and reveal UI.
    statements:
      type: dict
      example:
        '1': I once met a celebrity.
        '2': I can speak four languages.
        '3': I've never broken a bone.
      description: Three statements provided by the player when they are the speaker.
        Public to all once submitted.
    statements_submitted:
      type: boolean
      example: true
      description: True after the speaker has provided all three statements; enables
        discussion and voting UI for others.
    lie_index:
      type: num
      example: 2
      description: Which statement (1-3) is the lie. Private to the speaker until
        reveal; used for scoring.
    lie_revealed:
      type: boolean
      example: false
      description: Whether the lie has been revealed to all players.
    can_vote:
      type: boolean
      example: true
      description: Whether this player is eligible to vote this round (typically all
        non-speakers).
    vote_choice:
      type: num
      example: 2
      description: The statement number (1-3) this player believes is the lie. Use
        0 if not yet voted.
    has_voted:
      type: boolean
      example: true
      description: Whether this player has cast their vote this round.
    total_score:
      type: num
      example: 3
      description: 'Cumulative points across rounds: +1 for each correct vote; as
        speaker, +1 per other player fooled.'
    rounds_as_speaker:
      type: num
      example: 0
      description: Number of completed speaking turns this player has taken across
        all rounds.
  player_states_template:
    player_states:
      1:
        name: ''
        is_speaker: false
        statements: {}
        statements_submitted: false
        lie_index: 0
        lie_revealed: false
        can_vote: true
        vote_choice: 0
        has_voted: false
        total_score: 0
        rounds_as_speaker: 0
  players_example:
    tools:
    - clearCanvas
    - createPhaseIndicator
    - createTextDisplay
    - createAvatarSet
    - createScoreBoard
    - createTurnIndicator
    - createTextInputPanel
    - createVotingPanel
    - createStatementBoard
    - createTimer
    - createResultDisplay
    player_states:
      1:
        name: Alex
        is_speaker: true
        statements:
          '1': I once met a celebrity.
          '2': I can speak four languages.
          '3': I've never broken a bone.
        statements_submitted: true
        lie_index: 2
        lie_revealed: false
        can_vote: false
        vote_choice: 0
        has_voted: false
        total_score: 1
        rounds_as_speaker: 0
      2:
        name: Blake
        is_speaker: false
        statements: {}
        statements_submitted: false
        lie_index: 0
        lie_revealed: false
        can_vote: true
        vote_choice: 2
        has_voted: true
        total_score: 2
        rounds_as_speaker: 0
      3:
        name: Casey
        is_speaker: false
        statements: {}
        statements_submitted: false
        lie_index: 0
        lie_revealed: false
        can_vote: true
        vote_choice: 1
        has_voted: true
        total_score: 0
        rounds_as_speaker: 0
      4:
        name: Drew
        is_speaker: false
        statements: {}
        statements_submitted: false
        lie_index: 0
        lie_revealed: false
        can_vote: true
        vote_choice: 0
        has_voted: false
        total_score: 1
        rounds_as_speaker: 0
phases:
  0:
    name: Game Introduction
    description: Introduce the rules, objectives, scoring, and overall turn rotation
      to all players; prepare avatars and an initial scoreboard.
    actions:
    - description: Clear all previous UI elements (no exemptions needed for the first
        phase)
      tools:
      - clearCanvas
    - description: Create phase indicator for introduction (public)
      tools:
      - createPhaseIndicator
    - description: Display game rules, scoring (+1 per correct guess; as speaker,
        +1 per player fooled), and flow overview (public)
      tools:
      - createTextDisplay
    - description: Create player avatar set (public)
      tools:
      - createAvatarSet
    - description: Create initial scoreboard to track cumulative points (public)
      tools:
      - createScoreBoard
    completion_criteria:
      type: UI_displayed
      description: Game introduction has been displayed to all players.
    next_phase:
      id: 1
      name: Round Start
  1:
    name: Round Start
    description: Select/confirm the current speaker, reset round voting eligibility,
      and brief all players on the upcoming flow.
    actions:
    - description: Clear previous UI elements, exempt persistent scoreboard if present
      tools:
      - clearCanvas
    - description: Create phase indicator for round start (public)
      tools:
      - createPhaseIndicator
    - description: Create turn indicator highlighting the current speaker (public)
      tools:
      - createTurnIndicator
    - description: 'Display public instructions: speaker will submit three statements,
        then choose the lie; others will discuss and vote'
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Round start information shown; speaker and voter status prepared.
    next_phase:
      id: 2
      name: Statement Collection
  2:
    name: Statement Collection
    description: Current speaker privately submits their three statements for the
      round.
    actions:
    - description: Clear previous UI elements while preserving persistent scoreboard
      tools:
      - clearCanvas
    - description: Create phase indicator for statement collection (public)
      tools:
      - createPhaseIndicator
    - description: 'Show waiting/instructions to non-speakers (public): ''Waiting
        for the speaker to submit statements...'''
      tools:
      - createTextDisplay
    - description: Create private text input for the speaker to submit their three
        statements (individual audience)
      tools:
      - createTextInputPanel
    completion_criteria:
      type: player_action
      description: Speaker has submitted three statements via input, and relevant
        player state (player_states) has been updated (statements set, statements_submitted=true).
      wait_for: single_player_choice
      target_players:
        description: The current speaker
        condition: player.is_speaker == true
    next_phase:
      id: 3
      name: Lie Selection
  3:
    name: Lie Selection
    description: Speaker privately selects which of their submitted statements is
      the lie (1-3).
    actions:
    - description: Clear previous UI elements, exempt persistent scoreboard if present
      tools:
      - clearCanvas
    - description: Create phase indicator for lie selection (public)
      tools:
      - createPhaseIndicator
    - description: Create private voting panel for the speaker to choose the lie index
        (options 1,2,3)
      tools:
      - createVotingPanel
    - description: 'Show waiting/instructions to non-speakers (public): ''Speaker
        is choosing which statement is the lie...'''
      tools:
      - createTextDisplay
    completion_criteria:
      type: player_action
      description: Speaker has selected the lie index via voting panel, and relevant
        player state (player_states) has been updated (lie_index set).
      wait_for: single_player_choice
      target_players:
        description: The current speaker
        condition: player.is_speaker == true
    next_phase:
      id: 4
      name: Display Statements and Discussion
  4:
    name: Display Statements and Discussion
    description: Display the speaker's statements to all players and allow open discussion
      before voting.
    actions:
    - description: Clear previous UI elements, preserve persistent scoreboard
      tools:
      - clearCanvas
    - description: Create phase indicator for discussion (public)
      tools:
      - createPhaseIndicator
    - description: Display the three statements to all players (public)
      tools:
      - createStatementBoard
    - description: Show current speaker indicator (public)
      tools:
      - createTurnIndicator
    - description: Create discussion timer to guide conversation (public)
      tools:
      - createTimer
    completion_criteria:
      type: timer
      description: Discussion timer has expired.
    next_phase:
      id: 5
      name: Voting Phase
  5:
    name: Voting Phase
    description: All eligible non-speaker players vote on which statement (1-3) they
      believe is the lie.
    actions:
    - description: Clear discussion UI elements, exempt persistent scoreboard
      tools:
      - clearCanvas
    - description: Create phase indicator for voting (public)
      tools:
      - createPhaseIndicator
    - description: Create voting panel for eligible voters only (non-speakers with
        can_vote=true)
      tools:
      - createVotingPanel
    - description: 'Show waiting message to the speaker (public): ''Waiting for votes...'''
      tools:
      - createTextDisplay
    completion_criteria:
      type: player_action
      description: Votes have been received from all eligible voters and relevant
        player state (player_states) has been updated (has_voted=true, vote_choice
        set).
      wait_for: multiple_players_action
      target_players:
        description: All eligible voters (non-speakers)
        condition: player.is_speaker == false and player.can_vote == true
    next_phase:
      id: 6
      name: Reveal Phase
  6:
    name: Reveal Phase
    description: Reveal which statement was the lie to all players.
    actions:
    - description: Clear voting UI, preserve persistent scoreboard
      tools:
      - clearCanvas
    - description: Create phase indicator for reveal (public)
      tools:
      - createPhaseIndicator
    - description: Display statements board highlighting the lie index to everyone
        (public)
      tools:
      - createStatementBoard
    - description: Show public reveal announcement
      tools:
      - createResultDisplay
    completion_criteria:
      type: UI_displayed
      description: Reveal has been shown to all players (lie_revealed set to true).
    next_phase:
      id: 7
      name: Scoring Update
  7:
    name: Scoring Update
    description: Tally points for correct guesses and speaker deception; update and
      display the scoreboard.
    actions:
    - description: Clear reveal UI, preserve any persistent elements as needed
      tools:
      - clearCanvas
    - description: Create phase indicator for scoring (public)
      tools:
      - createPhaseIndicator
    - description: Create updated scoreboard showing cumulative totals (public)
      tools:
      - createScoreBoard
    - description: Display scoring summary for this turn (public)
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Scores have been updated and displayed.
    next_phase:
      id: 8
      name: Check Round Progress
  8:
    name: Check Round Progress
    description: Evaluate whether all players have completed the agreed number of
      speaking turns; otherwise continue to the next speaker.
    actions:
    - description: Clear scoring UI while preserving persistent scoreboard
      tools:
      - clearCanvas
    - description: Create phase indicator for round progress check (public)
      tools:
      - createPhaseIndicator
    - description: Display status of speaker rotation and remaining turns (public)
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Round progress has been evaluated; routing determined.
    next_phase:
      If all players have completed the agreed number of speaking turns:
        id: 99
        name: Game Over — Final Results
      Otherwise, continue to the next speaker's turn:
        id: 1
        name: Round Start
  99:
    name: Game Over — Final Results
    description: Display the final standings and congratulate the winner(s).
    actions:
    - description: Clear previous UI elements to present final results
      tools:
      - clearCanvas
    - description: Create phase indicator for final results (public)
      tools:
      - createPhaseIndicator
    - description: Create final scoreboard ranking all players by total_score (public)
      tools:
      - createScoreBoard
    - description: Create celebratory final result display (public)
      tools:
      - createResultDisplay
    completion_criteria:
      type: UI_displayed
      description: Final results have been displayed.
    next_phase: null
