declaration:
  description: A conversational party game where players take turns sharing three
    statements about themselves (two true, one false). Other players discuss and try
    to identify the lie through natural conversation and voting. Points are awarded
    for correct guesses and successful deception. The game rotates a speaker each
    round and ends after all players have been speaker for the agreed number of rounds.
  is_multiplayer: true
  min_players: 3
  player_states:
    name:
      type: string
      example: Player A
      description: Player's display name, visible to all.
    score:
      type: num
      example: 0
      description: Cumulative points across rounds.
    is_speaker:
      type: boolean
      example: false
      description: Whether this player is the current speaker; controls access to
        statement submission UI and hides voting UI.
    eligible_to_vote:
      type: boolean
      example: true
      description: Whether the player may vote this round (typically all non-speakers).
    statements:
      type: list
      example:
      - Statement 1
      - Statement 2
      - Statement 3
      description: Three statements provided when the player is the speaker. Visible
        to all players after submission.
    statements_locked:
      type: boolean
      example: false
      description: Whether the speaker has finalized their three statements for the
        round.
    lie_index:
      type: num
      example: 2
      description: Index (1-3) of the lie chosen by the speaker. Private until reveal.
    lie_revealed:
      type: boolean
      example: false
      description: Whether the lie index has been publicly revealed for the current
        speaker turn.
    has_voted:
      type: boolean
      example: false
      description: Whether the player has cast a vote in the current voting phase.
    vote_choice:
      type: num
      example: 3
      description: The player's vote for which statement is the lie (1-3).
    speaker_turns_completed:
      type: num
      example: 0
      description: Number of times this player has already acted as the speaker.
  player_states_template:
    player_states:
      1:
        name: ''
        score: 0
        is_speaker: false
        eligible_to_vote: false
        statements: []
        statements_locked: false
        lie_index: 0
        lie_revealed: false
        has_voted: false
        vote_choice: 0
        speaker_turns_completed: 0
  players_example:
    player_states:
      1:
        name: Alex
        score: 0
        is_speaker: true
        eligible_to_vote: false
        statements:
        - I once met a celebrity.
        - I can speak four languages.
        - I've never broken a bone.
        statements_locked: true
        lie_index: 2
        lie_revealed: false
        has_voted: false
        vote_choice: 0
        speaker_turns_completed: 0
      2:
        name: Bailey
        score: 0
        is_speaker: false
        eligible_to_vote: true
        statements: []
        statements_locked: false
        lie_index: 0
        lie_revealed: false
        has_voted: true
        vote_choice: 3
        speaker_turns_completed: 0
      3:
        name: Casey
        score: 0
        is_speaker: false
        eligible_to_vote: true
        statements: []
        statements_locked: false
        lie_index: 0
        lie_revealed: false
        has_voted: true
        vote_choice: 2
        speaker_turns_completed: 0
    tools:
    - clearCanvas
    - createPhaseIndicator
    - createTextDisplay
    - createAvatarSet
    - createScoreBoard
    - createTurnIndicator
    - createTextInputPanel
    - createVotingPanel
    - createStatementBoard
    - createHandsCard
    - createTimer
    - upsertScoreEntry
    - updateScoreBoard
    - createResultDisplay
phases:
  0:
    name: Game Introduction
    description: Introduce rules, setup, scoring, and round flow to all players.
    actions:
    - description: Clear canvas and create public phase indicator for the introduction
      tools:
      - clearCanvas
      - createPhaseIndicator
    - description: Display game rules, objectives, and flow overview to all players
      tools:
      - createTextDisplay
    - description: Create avatar set and an empty public scoreboard for tracking points
      tools:
      - createAvatarSet
      - createScoreBoard
    completion_criteria:
      type: UI_displayed
      description: Game introduction has been displayed to all players.
    next_phase:
      id: 1
      name: Turn Order Setup & First Speaker
  1:
    name: Turn Order Setup & First Speaker
    description: Confirm initial speaker selection and turn order. Ensure only the
      chosen speaker has is_speaker=true and all others are eligible_to_vote=true.
    actions:
    - description: Clear canvas, create public phase indicator, and show turn setup
        notes
      tools:
      - clearCanvas
      - createPhaseIndicator
      - createTextDisplay
    - description: Show current speaker to everyone
      tools:
      - createTurnIndicator
    - description: Show scoreboard to all players
      tools:
      - updateScoreBoard
    completion_criteria:
      type: UI_displayed
      description: Initial speaker and turn setup displayed to all players.
    next_phase:
      id: 2
      name: Statement Collection by Speaker
  2:
    name: Statement Collection by Speaker
    description: Speaker submits exactly three statements privately; others wait.
      On submission, statements are saved and statements_locked is set true.
    actions:
    - description: Clear canvas and create public phase indicator for statement collection
        (Tier 1)
      tools:
      - clearCanvas
      - createPhaseIndicator
    - description: Create private text input panel for the speaker to enter three
        statements (Tier 3)
      tools:
      - createTextInputPanel
    - description: Create waiting instructions for non-speakers (Tier 2)
      tools:
      - createTextDisplay
    - description: Show current speaker indicator to all players
      tools:
      - createTurnIndicator
    completion_criteria:
      type: player_action
      description: Speaker has submitted three statements via text input and relevant
        player state (statements, statements_locked) has been updated.
      wait_for: single_player_choice
      target_players:
        description: The current speaker
        condition: player.is_speaker == true
    next_phase:
      id: 3
      name: Speaker Chooses Lie (Private)
  3:
    name: Speaker Chooses Lie (Private)
    description: Speaker privately selects which statement (1-3) is the lie; lie_index
      stored while lie_revealed remains false.
    actions:
    - description: Create private voting panel for the speaker to pick the lie index
        (Tier 3) and show waiting note to others (Tier 2)
      tools:
      - createVotingPanel
      - createTextDisplay
    - description: Maintain speaker turn indicator for clarity
      tools:
      - createTurnIndicator
    completion_criteria:
      type: player_action
      description: Speaker has selected the lie index via voting panel and relevant
        player state (lie_index) has been updated.
      wait_for: single_player_choice
      target_players:
        description: The current speaker
        condition: player.is_speaker == true
    next_phase:
      id: 4
      name: Display Statements & Discussion
  4:
    name: Display Statements & Discussion
    description: Show the speaker’s statements to all players and start a timed open
      discussion. Lie remains unrevealed.
    actions:
    - description: Clear canvas and create public phase indicator for discussion
      tools:
      - clearCanvas
      - createPhaseIndicator
    - description: Display the three statements to all players
      tools:
      - createStatementBoard
    - description: Start a discussion timer visible to all players
      tools:
      - createTimer
    - description: Show current speaker indicator
      tools:
      - createTurnIndicator
    completion_criteria:
      type: timer
      description: Discussion timer has expired.
    next_phase:
      id: 5
      name: Guess the Lie — Voting
  5:
    name: Guess the Lie — Voting
    description: All non-speaker players who are eligible_to_vote choose which statement
      (1-3) they believe is the lie.
    actions:
    - description: Create voting panel for eligible voters (Tier 2) and a waiting
        message for the speaker (Tier 2)
      tools:
      - createVotingPanel
      - createTextDisplay
    - description: Keep statements visible for reference and show turn indicator
      tools:
      - createStatementBoard
      - createTurnIndicator
    completion_criteria:
      type: player_action
      description: All eligible voters have cast their votes and relevant player state
        (has_voted, vote_choice) has been updated.
      wait_for: multiple_players_action
      target_players:
        description: All non-speaker players eligible to vote
        condition: player.eligible_to_vote == true
    next_phase:
      id: 6
      name: Reveal Lie & Announce Voting Results
  6:
    name: Reveal Lie & Announce Voting Results
    description: Reveal which statement was the lie and summarize how players voted.
      Set lie_revealed to true.
    actions:
    - description: Clear canvas and create public reveal indicator and results display
      tools:
      - clearCanvas
      - createPhaseIndicator
      - createResultDisplay
    - description: Show the statements board with the revealed lie highlighted for
        everyone
      tools:
      - createStatementBoard
    - description: Display a summary text of voting outcomes
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Lie has been revealed and results announced to all players.
    next_phase:
      id: 7
      name: Score Update & Leaderboard
  7:
    name: Score Update & Leaderboard
    description: 'Award points: voters who guessed correctly gain points; speaker
      gains points for each incorrect guess. Update scoreboard accordingly.'
    actions:
    - description: Upsert individual player scores based on the round outcome
      tools:
      - upsertScoreEntry
    - description: Refresh the public scoreboard to reflect new rankings
      tools:
      - updateScoreBoard
    - description: Show a brief round summary
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Scores updated and leaderboard refreshed.
    next_phase:
      id: 8
      name: Check End Conditions & Rotate Speaker
  8:
    name: Check End Conditions & Rotate Speaker
    description: Evaluate whether all players have completed the required number of
      speaker turns. If not finished, prepare to rotate the speaker.
    actions:
    - description: Display status of speaker_turns_completed and next steps
      tools:
      - createTextDisplay
    - description: Keep scoreboard visible for context
      tools:
      - updateScoreBoard
    completion_criteria:
      type: UI_displayed
      description: End condition check displayed; state prepared for routing.
    next_phase:
      If all required speaker turns are completed for all players:
        id: 99
        name: Final Results
      Otherwise, continue to next speaker:
        id: 9
        name: Next Speaker Setup
  9:
    name: Next Speaker Setup
    description: 'Rotate to the next speaker: set is_speaker=true for the new speaker,
      reset eligible_to_vote for others, and clear per-round fields.'
    actions:
    - description: Clear canvas, create public phase indicator, and show next speaker
        information
      tools:
      - clearCanvas
      - createPhaseIndicator
      - createTextDisplay
    - description: Show updated turn indicator to all players
      tools:
      - createTurnIndicator
    - description: Keep scoreboard visible
      tools:
      - updateScoreBoard
    completion_criteria:
      type: UI_displayed
      description: Next speaker setup displayed to all players.
    next_phase:
      id: 2
      name: Statement Collection by Speaker
  99:
    name: Final Results
    description: Present final standings and congratulate the winner(s).
    actions:
    - description: Clear canvas and create final results indicator
      tools:
      - clearCanvas
      - createPhaseIndicator
    - description: Display final leaderboard using the scoreboard
      tools:
      - updateScoreBoard
    - description: Show game over message to all players
      tools:
      - createResultDisplay
    completion_criteria:
      type: UI_displayed
      description: Final results displayed. Game concluded.
    next_phase: null
