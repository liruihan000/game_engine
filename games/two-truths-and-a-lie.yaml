declaration:
  description: A conversational party game of Two Truths and a Lie. Players rotate
    as the speaker, share three statements (two true, one false), discuss, and vote
    on the lie. Points are awarded for correct guesses and for successfully deceiving
    others. Natural conversation is interpreted by the orchestrator; no commands required.
  is_multiplayer: true
  min_players: 3
  player_states:
    name:
      type: string
      example: Ava
      description: Player's display name, visible to all.
    score:
      type: num
      example: 3
      description: Total points accumulated across rounds.
    is_speaker:
      type: boolean
      example: false
      description: Whether this player is the current speaker. Speakers do not vote
        and can reveal the lie.
    speaking_order:
      type: num
      example: 2
      description: Turn order index used for rotation.
    has_spoken_this_round:
      type: boolean
      example: false
      description: Has this player already taken a speaker turn in the current round.
    submitted_statements:
      type: boolean
      example: false
      description: Whether the player (when speaker) has submitted their three statements.
    statements:
      type: list
      example:
      - I visited Japan last year.
      - I can juggle five balls.
      - I hate chocolate.
      description: The three statements provided by the current speaker. Public during
        discussion and voting.
    lie_index:
      type: num
      example: 2
      description: Index of the false statement (1-3). Private to the speaker until
        reveal.
    lie_revealed:
      type: boolean
      example: false
      description: Whether the speaker's lie has been publicly revealed.
    can_vote:
      type: boolean
      example: true
      description: Whether the player is eligible to vote in the current voting phase
        (non-speaker).
    vote_choice:
      type: num
      example: 3
      description: Chosen statement index (1-3) the player believes is the lie. 0
        means no vote.
    has_voted:
      type: boolean
      example: false
      description: Whether the player has submitted a vote this turn.
  player_states_template:
    player_states:
      1:
        name: ''
        score: 0
        is_speaker: false
        speaking_order: 0
        has_spoken_this_round: false
        submitted_statements: false
        statements: []
        lie_index: 0
        lie_revealed: false
        can_vote: false
        vote_choice: 0
        has_voted: false
  players_example:
    player_states:
      1:
        name: Ava
        score: 2
        is_speaker: true
        speaking_order: 1
        has_spoken_this_round: false
        submitted_statements: true
        statements:
        - I once met a famous actor at an airport.
        - I can speak four languages fluently.
        - I've never broken a bone.
        lie_index: 2
        lie_revealed: false
        can_vote: false
        vote_choice: 0
        has_voted: false
      2:
        name: Ben
        score: 1
        is_speaker: false
        speaking_order: 2
        has_spoken_this_round: false
        submitted_statements: false
        statements: []
        lie_index: 0
        lie_revealed: false
        can_vote: true
        vote_choice: 2
        has_voted: true
      3:
        name: Casey
        score: 0
        is_speaker: false
        speaking_order: 3
        has_spoken_this_round: false
        submitted_statements: false
        statements: []
        lie_index: 0
        lie_revealed: false
        can_vote: true
        vote_choice: 3
        has_voted: false
      4:
        name: Dana
        score: 3
        is_speaker: false
        speaking_order: 4
        has_spoken_this_round: false
        submitted_statements: false
        statements: []
        lie_index: 0
        lie_revealed: false
        can_vote: true
        vote_choice: 2
        has_voted: true
  audience_groups:
    current_speaker:
      description: The player who is currently presenting statements and holds private
        knowledge of the lie.
      selection_criteria: player.is_speaker == true
    eligible_voters:
      description: Non-speaker players allowed to cast votes.
      selection_criteria: player.is_speaker == false and player.can_vote == true
    vote_pending:
      description: Eligible voters who have not yet submitted a vote.
      selection_criteria: player.can_vote == true and player.has_voted == false
    non_speakers:
      description: All players who are not currently the speaker.
      selection_criteria: player.is_speaker == false
    not_spoken_this_round:
      description: Players who have not yet taken a speaker turn in the current round.
      selection_criteria: player.has_spoken_this_round == false
phases:
  0:
    name: Game Introduction
    description: Introduce rules, objectives, rotation, and scoring. Initialize the
      scoreboard and show the overall flow.
    actions:
    - description: Delete previous UI and create a public phase indicator titled 'Game
        Introduction'
      tools:
      - deleteItem
      - createPhaseIndicator
    - description: Display rules and objectives to all players
      tools:
      - createTextDisplay
    - description: Create and display a public scoreboard initialized with all players'
        scores
      tools:
      - createScoreBoard
    - description: Show a public overview of turn rotation and how statements, voting,
        reveal, and scoring work
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Game introduction and initial scoreboard have been displayed to
        all players.
    next_phase:
      id: 1
      name: Speaker Statement Collection
  1:
    name: Speaker Statement Collection
    description: Current speaker privately submits three statements (two true, one
      false). Others wait.
    actions:
    - description: Delete previous UI and create a public phase indicator titled 'Statement
        Collection' and identify the current speaker
      tools:
      - deleteItem
      - createPhaseIndicator
    - description: 'Create private text input for the speaker to submit three statements
        and select/indicate the lie privately (audience: current speaker only)'
      tools:
      - createTextInputPanel
    - description: 'Create waiting/instructions text for non-speaker players (audience:
        non-speakers)'
      tools:
      - createTextDisplay
    - description: Create a public turn indicator highlighting the current speaker
      tools:
      - createTurnIndicator
    completion_criteria:
      type: player_action
      description: Speaker has submitted their three statements via the input panel,
        and relevant player state (player_states) has been updated (submitted_statements=true,
        statements populated, lie_index set privately).
      wait_for: single_player_choice
      target_players:
        description: The current speaker
        condition: player.is_speaker == true
    next_phase:
      id: 2
      name: Display Statements & Discussion
  2:
    name: Display Statements & Discussion
    description: Show the three statements to everyone and allow open discussion within
      a timer.
    actions:
    - description: Delete previous UI and create a public phase indicator titled 'Discussion'
      tools:
      - deleteItem
      - createPhaseIndicator
    - description: Display the speaker's three statements to all players
      tools:
      - createStatementBoard
    - description: Start a public discussion timer
      tools:
      - createTimer
    - description: Show a public turn indicator with the current speaker
      tools:
      - createTurnIndicator
    completion_criteria:
      type: timer
      description: Discussion timer has expired.
    next_phase:
      id: 3
      name: Voting Phase
  3:
    name: Voting Phase
    description: Eligible voters (all non-speakers) vote on which statement (1-3)
      is the lie.
    actions:
    - description: Delete previous UI and create a public phase indicator titled 'Voting
        Phase'
      tools:
      - deleteItem
      - createPhaseIndicator
    - description: Create a private voting panel for eligible voters only with options
        ['1','2','3']
      tools:
      - createVotingPanel
    - description: Show a waiting message to the speaker indicating they do not vote
      tools:
      - createTextDisplay
    - description: Display a public turn indicator with the current speaker
      tools:
      - createTurnIndicator
    completion_criteria:
      type: player_action
      description: All eligible voters have cast their votes and relevant player state
        (player_states) has been updated (vote_choice set and has_voted=true for each).
      wait_for: multiple_players_action
      target_players:
        description: All eligible non-speaker voters
        condition: player.is_speaker == false and player.can_vote == true
    next_phase:
      id: 4
      name: Speaker Reveal
  4:
    name: Speaker Reveal
    description: Speaker reveals which statement was the lie.
    actions:
    - description: Delete previous UI and create a public phase indicator titled 'Reveal'
      tools:
      - deleteItem
      - createPhaseIndicator
    - description: 'Create a private voting panel for the speaker to confirm/select
        the lie index [''1'',''2'',''3''] and trigger the reveal (audience: current
        speaker only)'
      tools:
      - createVotingPanel
    - description: Show a public waiting message for non-speaker players
      tools:
      - createTextDisplay
    completion_criteria:
      type: player_action
      description: Speaker has revealed the lie and relevant player state (player_states)
        has been updated (lie_revealed=true and lie_index confirmed if needed).
      wait_for: single_player_choice
      target_players:
        description: The current speaker
        condition: player.is_speaker == true
    next_phase:
      id: 5
      name: Score Update & Results
  5:
    name: Score Update & Results
    description: Highlight the lie, show voting results, and update scores for correct
      guesses and deception.
    actions:
    - description: Delete previous UI and create a public phase indicator titled 'Results
        & Scoring'
      tools:
      - deleteItem
      - createPhaseIndicator
    - description: Update the statements board to highlight the revealed lie
      tools:
      - updateStatementBoard
    - description: Display a public results summary (who guessed correctly, deception
        success)
      tools:
      - createResultDisplay
    - description: Upsert individual player scores based on results and refresh the
        public leaderboard
      tools:
      - upsertScoreEntry
      - updateScoreBoard
    - description: Provide a public text summary of point allocation rules applied
        this turn
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Results have been announced and scores updated on the scoreboard.
    next_phase:
      id: 6
      name: Check Round Completion
  6:
    name: Check Round Completion
    description: Check if all players have completed their speaker turns in this round and set the next speaker. Set the next speaker. If round is complete, decide whether to continue or end game.
    actions:
    - description: Delete previous UI and create a public phase indicator titled 'Round Progress Check'
      tools:
      - deleteItem
      - createPhaseIndicator
    - description: Show a public status display indicating which players have already spoken this round
      tools:
      - createTextDisplay
    - description: Determine and set the next speaker based on turn order and completed rounds
      tools:
      - updatePlayerStates
    completion_criteria:
      type: UI_displayed
      description: Round progress has been displayed, next speaker has been determined and updated in player_states.
    next_phase:
      If all players have completed their speaker turns in this round:
        id: 7
        name: Continue or End Decision
      Otherwise (more players need to speak):
        id: 2
        name: Speaker Statement Collection
  7:
    name: Continue or End Decision
    description: All players decide whether to play another round or end the game.
    actions:
    - description: Delete previous UI and create a public phase indicator titled 'Continue
        or End'
      tools:
      - deleteItem
      - createPhaseIndicator
    - description: Create a public decision voting panel for all players with options
        ['Play another round','End game']
      tools:
      - createVotingPanel
    - description: Display a public explanation of how new rounds reset speaking order
        status
      tools:
      - createTextDisplay
    completion_criteria:
      type: player_action
      description: All players have submitted their continue/end decision and relevant
        player state (player_states) has been updated to record their choice.
      wait_for: all_players_action
      target_players:
        description: All players (union of speaker and eligible voters)
        condition: player.can_vote == true or player.is_speaker == true
    next_phase:
      If 'Play another round' receives the winning decision:
        id: 8
        name: New Round Setup
      If 'End game' receives the winning decision:
        id: 99
        name: Final Results
  8:
    name: New Round Setup
    description: Reset round flags and assign the next round's starting speaker according
      to speaking order.
    actions:
    - description: Delete previous UI and create a public phase indicator titled 'New
        Round Setup'
      tools:
      - deleteItem
      - createPhaseIndicator
    - description: Display public text describing the reset of has_spoken_this_round
        for all players and the assignment of the next speaker (is_speaker=true) based
        on speaking_order
      tools:
      - createTextDisplay
    - description: Show a public turn indicator for the newly assigned speaker
      tools:
      - createTurnIndicator
    completion_criteria:
      type: UI_displayed
      description: New round setup information has been displayed and player_states
        prepared for the next speaker.
    next_phase:
      id: 1
      name: Speaker Statement Collection
  99:
    name: Final Results
    description: Display the final leaderboard and conclude the game.
    actions:
    - description: Delete previous UI and create a public phase indicator titled 'Final
        Results'
      tools:
      - deleteItem
      - createPhaseIndicator
    - description: Update and display the final scoreboard standings
      tools:
      - updateScoreBoard
    - description: Create a public final results display with congratulations and
        summary
      tools:
      - createResultDisplay
    - description: Show a public text message with thanks and instructions to exit
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Final results and leaderboard have been displayed to all players.
    next_phase: null
