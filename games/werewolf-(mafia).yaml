declaration:
  description: 'Hidden-role social deduction. At night, Werewolves secretly choose
    an elimination target, the Doctor chooses a player to protect, and the Detective
    investigates a player. Resolution order: kill attempt → protection check → investigation.
    Morning reveals results. Game Flow Navigation: role_assignment → first_night →
    first_morning → first_day_discussion → first_day_voting → (night → morning → day_discussion
    → day_voting) cycle until win conditions met → game_over. Win conditions: Werewolves
    win if they equal or outnumber villagers; Village wins if all werewolves are eliminated.'
  is_multiplayer: true
  min_players: 4
  roles:
  - name: Villager
    description: Has no special abilities. Win by eliminating all werewolves via daytime
      votes.
  - name: Werewolf
    description: Each night, coordinate to select one player to eliminate. Win if
      werewolves equal or outnumber villagers.
  - name: Doctor
    description: Each night, choose one player to protect from elimination.
  - name: Detective
    description: Each night, investigate one player to learn whether they are a werewolf.
  player_states:
    name:
      type: string
      example: Player A
      description: Player's display name.
    role:
      type: string
      example: Villager
      description: Hidden role assigned to the player (e.g., Villager, Werewolf, Doctor,
        Detective).
    faction:
      type: string
      example: Village
      description: 'Alignment used for win conditions: "Village" or "Werewolf".'
    is_alive:
      type: boolean
      example: true
      description: Whether the player is still active in the game (true=alive; false=eliminated).
    current_vote_target:
      type: num
      example: 0
      description: Player ID this player is currently voting for during the day; 0
        means no vote.
    votes_received:
      type: num
      example: 0
      description: Number of votes currently on this player during the day.
    night_action_target:
      type: num
      example: 0
      description: During the night, the chosen target's player ID for roles with
        night actions; 0 means none.
    known_alignments:
      type: dict
      example:
        2: Not Werewolf
      description: 'For Detective: mapping of player_id → investigation result ("Werewolf"
        or "Not Werewolf").'
    has_voted_today:
      type: boolean
      example: false
      description: Whether the player has cast a vote during the current day.
  player_states_template:
    player_states:
      1:
        name: ''
        role: ''
        faction: ''
        is_alive: true
        current_vote_target: 0
        votes_received: 0
        night_action_target: 0
        known_alignments: {}
        has_voted_today: false
  players_example:
    player_states:
      1:
        name: Alpha
        role: Werewolf
        faction: Werewolf
        is_alive: true
        current_vote_target: 0
        votes_received: 0
        night_action_target: 2
        known_alignments: {}
        has_voted_today: false
      2:
        name: Beta
        role: Villager
        faction: Village
        is_alive: true
        current_vote_target: 0
        votes_received: 0
        night_action_target: 0
        known_alignments: {}
        has_voted_today: false
      3:
        name: Gamma
        role: Doctor
        faction: Village
        is_alive: true
        current_vote_target: 0
        votes_received: 0
        night_action_target: 2
        known_alignments: {}
        has_voted_today: false
      4:
        name: Delta
        role: Detective
        faction: Village
        is_alive: true
        current_vote_target: 0
        votes_received: 0
        night_action_target: 1
        known_alignments:
          1: Werewolf
        has_voted_today: false
phases:
  0:
    name: Game Introduction
    description: Introduce the game rules, setup, and objectives to all players, including
      night action order and daytime process.
    actions:
    - description: Initialize UI with title, description, background, avatar set,
        and current phase indicator
      tools:
      - setGlobalTitle
      - setGlobalDescription
      - createBackgroundControl
      - changeBackgroundColor
      - createAvatarSet
      - createPhaseIndicator
    - description: Display game rules, roles, and the night/day flow overview
      tools:
      - createTextDisplay
    - description: Display win conditions for Village and Werewolves
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Game introduction has been displayed to all players.
    next_phase:
      id: 1
      name: Role Assignment
  1:
    name: Role Assignment
    description: Randomly assign hidden roles (Werewolf, Doctor, Detective, Villager)
      to players according to game configuration, and privately notify each player.
    actions:
    - description: Show role assignment overview and indicate that roles will be assigned
        secretly
      tools:
      - createTextDisplay
      - createPhaseIndicator
    - description: Confirm that each player has been privately informed of their role
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: All roles have been assigned and players have been notified.
    next_phase:
      id: 2
      name: Night — Werewolves Choose Target
  2:
    name: Night — Werewolves Choose Target
    description: All living Werewolves secretly coordinate and select one player to
      eliminate.
    actions:
    - description: Set night ambiance and display instructions to Werewolves to choose
        a target
      tools:
      - changeBackgroundColor
      - createPhaseIndicator
      - createTextDisplay
    completion_criteria:
      type: player_action
      description: Werewolves' elimination target has been submitted, and relevant
        player state (player_states) has been updated.
      wait_for: multiple_players_action
      target_players:
        description: All living players with the role 'Werewolf'
        condition: player.role == 'Werewolf' and player.is_alive == true
    next_phase:
      id: 3
      name: Night — Doctor Protects
  3:
    name: Night — Doctor Protects
    description: The living Doctor chooses one player to protect from elimination
      tonight.
    actions:
    - description: Display instructions to the Doctor to select a protection target
      tools:
      - createPhaseIndicator
      - createTextDisplay
    completion_criteria:
      type: player_action
      description: Doctor's protection target has been submitted, and relevant player
        state (player_states) has been updated.
      wait_for: single_player_choice
      target_players:
        description: The living Doctor
        condition: player.role == 'Doctor' and player.is_alive == true
    next_phase:
      id: 4
      name: Night — Detective Investigates
  4:
    name: Night — Detective Investigates
    description: The living Detective investigates one player to learn whether they
      are a Werewolf.
    actions:
    - description: Display instructions to the Detective to choose an investigation
        target
      tools:
      - createPhaseIndicator
      - createTextDisplay
    completion_criteria:
      type: player_action
      description: Detective's investigation target has been submitted, and relevant
        player state (player_states) has been updated.
      wait_for: single_player_choice
      target_players:
        description: The living Detective
        condition: player.role == 'Detective' and player.is_alive == true
    next_phase:
      id: 5
      name: Dawn — Night Resolution and Reveal
  5:
    name: Dawn — Night Resolution and Reveal
    description: 'Resolve the night: apply Werewolves'' kill attempt, check Doctor''s
      protection, and reveal the outcome to all players.'
    actions:
    - description: Show resolution summary; if a player died, mark them dead and display
        the result
      tools:
      - changeBackgroundColor
      - createPhaseIndicator
      - createTextDisplay
      - markPlayerDead
      - createResultDisplay
    completion_criteria:
      type: UI_displayed
      description: Night results have been revealed to all players.
    next_phase:
      id: 6
      name: Check Win Conditions (Post-Night)
  6:
    name: Check Win Conditions (Post-Night)
    description: Evaluate whether either side has won after the night; otherwise proceed
      to daytime.
    actions:
    - description: Display a brief status check and prepare routing based on current
        living counts
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Win condition evaluation finished; state prepared for routing.
    next_phase:
      If no living Werewolves remain:
        id: 99
        name: Game Over — Village Wins
      If living Werewolves are equal to or outnumber living Villagers:
        id: 99
        name: Game Over — Werewolves Win
      Otherwise, continue to daytime discussion:
        id: 7
        name: Daytime Discussion
  7:
    name: Daytime Discussion
    description: All surviving players discuss and share information before voting.
    actions:
    - description: Set daytime ambiance, show discussion timer, and outline discussion
        prompts
      tools:
      - changeBackgroundColor
      - createPhaseIndicator
      - createTextDisplay
    completion_criteria:
      type: timer
      description: Wait for the discussion timer to end.
    next_phase:
      id: 8
      name: Day Voting
  8:
    name: Day Voting
    description: All surviving players vote to select a player to eliminate.
    actions:
    - description: Create and display voting UI for all surviving players
      tools:
      - createPhaseIndicator
      - createVotingPanel
    completion_criteria:
      type: player_action
      description: Votes have been received from all surviving players, and relevant
        player state (player_states) has been updated.
      wait_for: all_players_action
      target_players:
        description: All surviving players
        condition: player.is_alive == true
    next_phase:
      id: 9
      name: Announce Voting Results & Elimination
  9:
    name: Announce Voting Results & Elimination
    description: Announce the voting outcome; if a player is eliminated, reveal and
      mark them as dead.
    actions:
    - description: Display results; if a player is eliminated, mark them dead and
        show elimination summary
      tools:
      - createPhaseIndicator
      - createResultDisplay
      - markPlayerDead
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Voting results and any elimination have been displayed.
    next_phase:
      id: 10
      name: Check Win Conditions (Post-Day)
  10:
    name: Check Win Conditions (Post-Day)
    description: Evaluate victory conditions after the daytime elimination; continue
      to the next night if no winner.
    actions:
    - description: Display a brief status check and prepare routing based on current
        living counts
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Win condition evaluation finished; state prepared for routing.
    next_phase:
      If no living Werewolves remain:
        id: 99
        name: Game Over — Village Wins
      If living Werewolves are equal to or outnumber living Villagers:
        id: 99
        name: Game Over — Werewolves Win
      Otherwise, continue the night cycle:
        id: 2
        name: Night — Werewolves Choose Target
  99:
    name: Game Over
    description: Display the winning side and conclude the game.
    actions:
    - description: Show final results and end-of-game summary
      tools:
      - changeBackgroundColor
      - createResultDisplay
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Final results have been displayed.
    next_phase: null
