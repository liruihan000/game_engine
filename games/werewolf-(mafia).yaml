declaration:
  description: 'A social deduction game where nights allow secret actions by special
    roles and days focus on discussion and voting. Night actions resolve in strict
    order: werewolf kill attempt → doctor protection check → detective investigation.
    Morning reveals outcomes. Game Flow Navigation: role_assignment → first_night
    → first_morning → first_day_discussion → first_day_voting → (night → morning →
    day_discussion → day_voting) cycle until win conditions are met → game_over. Werewolves
    win if they equal or outnumber villagers; village wins if all werewolves are eliminated.'
  is_multiplayer: true
  min_players: 4
  roles:
  - name: Villager
    description: No special night action; aims to identify and eliminate all werewolves.
  - name: Werewolf
    description: Secretly chooses a target at night to eliminate with the pack.
  - name: Doctor
    description: Selects one player at night to protect from elimination.
  - name: Detective
    description: Investigates one player at night to learn if they are a werewolf.
  player_states:
    name:
      type: string
      example: Player A
      description: Player's display name.
    role:
      type: string
      example: Villager
      description: Assigned role (hidden from other players, clearly displayed to
        the assigned player).
    is_alive:
      type: boolean
      example: true
      description: Whether the player is still in the game.
  player_states_template:
    player_states:
      1:
        name: ''
        role: ''
        is_alive: true
  players_example:
    player_states:
      1:
        name: Alpha
        role: Werewolf
        is_alive: true
      2:
        name: Bravo
        role: Doctor
        is_alive: true
      3:
        name: Charlie
        role: Detective
        is_alive: true
      4:
        name: Delta
        role: Villager
        is_alive: true
phases:
  0:
    name: Game Introduction
    description: Introduce the game rules, setup, roles, and objectives to all players.
      Explain night/day cycle, voting, elimination, and win conditions.
    actions:
    - description: Clear previous UI and set welcoming background for introduction
      tools:
      - clearCanvas
      - changeBackgroundColor
    - description: Show phase indicator labeled 'Game Introduction'
      tools:
      - createPhaseIndicator
    - description: Display game rules, role summaries (Villager, Werewolf, Doctor,
        Detective), night/day sequence, and win conditions
      tools:
      - createTextDisplay
    - description: Display player list and any game configuration notes
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Game introduction has been displayed to all players.
    next_phase:
      id: 1
      name: Role Assignment
  1:
    name: Role Assignment
    description: Randomly assign roles to all players and display each player's role
      privately via their own character card. Do not conceal roles from the assigned
      player.
    actions:
    - description: Prepare the canvas and neutral background for private role showing
      tools:
      - clearCanvas
      - changeBackgroundColor
    - description: Show phase indicator labeled 'Role Assignment'
      tools:
      - createPhaseIndicator
    - description: Create player avatar set
      tools:
      - createAvatarSet
    - description: Create and display a private character card to each player showing
        their assigned role and its description
      tools:
      - createCharacterCard
    completion_criteria:
      type: UI_displayed
      description: All roles have been assigned and each player can clearly see their
        specific role displayed on their private character card.
    next_phase:
      id: 2
      name: First Night — Werewolves Choose Target
  2:
    name: First Night — Werewolves Choose Target
    description: All living werewolves privately choose a single target to attack
      using a voting panel.
    actions:
    - description: Switch to night theme, clear previous UI, and indicate the werewolves'
        turn
      tools:
      - clearCanvas
      - changeBackgroundColor
      - createPhaseIndicator
      - createTextDisplay
    - description: Create private voting panel for living werewolves to collectively
        select one living target
      tools:
      - createVotingPanel
    completion_criteria:
      type: player_action
      description: Votes from all living werewolves have been received via the voting
        panel, and relevant player state (player_states) has been updated with the
        selected night target.
      wait_for: all_players_action
      target_players:
        description: All living players with the role Werewolf
        condition: player.role == 'Werewolf' and player.is_alive == true
    next_phase:
      id: 3
      name: First Night — Doctor Chooses Protection
  3:
    name: First Night — Doctor Chooses Protection
    description: The living Doctor privately selects one player to protect from elimination
      tonight.
    actions:
    - description: Show phase indicator for Doctor's turn and brief instruction
      tools:
      - createPhaseIndicator
      - createTextDisplay
    - description: Create private voting panel for the Doctor to select a protection
        target from all living players
      tools:
      - createVotingPanel
    completion_criteria:
      type: player_action
      description: Doctor's protection choice has been received via the voting panel,
        and relevant player state (player_states) has been updated.
      wait_for: single_player_choice
      target_players:
        description: The living Doctor
        condition: player.role == 'Doctor' and player.is_alive == true
    next_phase:
      id: 4
      name: First Night — Detective Investigates
  4:
    name: First Night — Detective Investigates
    description: The living Detective privately selects one player to investigate
      to learn if they are a werewolf.
    actions:
    - description: Show phase indicator for Detective's turn and brief instruction
      tools:
      - createPhaseIndicator
      - createTextDisplay
    - description: Create private voting panel for the Detective to select an investigation
        target from all living players
      tools:
      - createVotingPanel
    completion_criteria:
      type: player_action
      description: Detective's investigation choice has been received via the voting
        panel, and relevant player state (player_states) has been updated.
      wait_for: single_player_choice
      target_players:
        description: The living Detective
        condition: player.role == 'Detective' and player.is_alive == true
    next_phase:
      id: 5
      name: First Night — Detective Receives Result
  5:
    name: First Night — Detective Receives Result
    description: Privately reveal to the Detective whether the investigated player
      is a Werewolf.
    actions:
    - description: Maintain night theme and show a private result message to the Detective
        only
      tools:
      - createPhaseIndicator
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: The Detective's investigation result has been privately displayed.
    next_phase:
      id: 6
      name: First Morning — Announce Night Results
  6:
    name: First Morning — Announce Night Results
    description: Reveal whether a player was eliminated during the night (or if no
      one was eliminated). Update player status accordingly.
    actions:
    - description: Switch to morning theme, clear night UI, and show morning phase
        indicator
      tools:
      - clearCanvas
      - changeBackgroundColor
      - createPhaseIndicator
    - description: Display a summary of night events (protected/attacked outcome)
      tools:
      - createTextDisplay
    - description: If a player was eliminated, announce and mark them as dead
      tools:
      - createResultDisplay
      - markPlayerDead
    completion_criteria:
      type: UI_displayed
      description: Night results have been publicly announced and player status updated.
    next_phase:
      id: 7
      name: First Day Discussion
  7:
    name: First Day Discussion
    description: Open discussion among all surviving players. Use a timer to structure
      the discussion period.
    actions:
    - description: Show day discussion indicator and guidance, then start a discussion
        timer
      tools:
      - createPhaseIndicator
      - createTextDisplay
      - createTimer
    completion_criteria:
      type: timer
      description: The discussion timer has finished.
    next_phase:
      id: 8
      name: First Day Voting
  8:
    name: First Day Voting
    description: All surviving players vote to eliminate one player.
    actions:
    - description: Present voting instructions and the voting panel to all surviving
        players
      tools:
      - createPhaseIndicator
      - createTextDisplay
      - createVotingPanel
    completion_criteria:
      type: player_action
      description: Votes have been received from all surviving players via the voting
        panel, and relevant player state (player_states) has been updated.
      wait_for: all_players_action
      target_players:
        description: All surviving players
        condition: player.is_alive == true
    next_phase:
      id: 9
      name: Announce First Day Voting Results
  9:
    name: Announce First Day Voting Results
    description: Display the voting results and eliminate the selected player, if
      any.
    actions:
    - description: Clear voting UI, show result summary, and mark eliminated player
        as dead
      tools:
      - clearCanvas
      - createTextDisplay
      - createResultDisplay
      - markPlayerDead
    completion_criteria:
      type: UI_displayed
      description: Day voting results have been announced and player status updated.
    next_phase:
      id: 10
      name: Check Win Conditions
  10:
    name: Check Win Conditions
    description: Evaluate whether either side has already won; otherwise continue
      with the night phase.
    actions:
    - description: Display a brief status check message while win conditions are evaluated
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Win condition evaluation finished; state prepared for routing.
    next_phase:
      If no living Werewolves remain:
        id: 98
        name: Game Over — Village Wins
      If living Werewolves are equal to or outnumber living Villagers:
        id: 99
        name: Game Over — Werewolves Win
      Otherwise, proceed to the next night:
        id: 11
        name: Night — Werewolves Choose Target
  11:
    name: Night — Werewolves Choose Target
    description: All living werewolves privately choose a single target to attack
      using a voting panel.
    actions:
    - description: Switch to night theme, clear day UI, and indicate the werewolves'
        turn
      tools:
      - clearCanvas
      - changeBackgroundColor
      - createPhaseIndicator
      - createTextDisplay
    - description: Create private voting panel for living werewolves to collectively
        select one living target
      tools:
      - createVotingPanel
    completion_criteria:
      type: player_action
      description: Votes from all living werewolves have been received via the voting
        panel, and relevant player state (player_states) has been updated with the
        selected night target.
      wait_for: all_players_action
      target_players:
        description: All living players with the role Werewolf
        condition: player.role == 'Werewolf' and player.is_alive == true
    next_phase:
      id: 12
      name: Night — Doctor Chooses Protection
  12:
    name: Night — Doctor Chooses Protection
    description: The living Doctor privately selects one player to protect from elimination
      tonight.
    actions:
    - description: Show phase indicator for Doctor's turn and brief instruction
      tools:
      - createPhaseIndicator
      - createTextDisplay
    - description: Create private voting panel for the Doctor to select a protection
        target from all living players
      tools:
      - createVotingPanel
    completion_criteria:
      type: player_action
      description: Doctor's protection choice has been received via the voting panel,
        and relevant player state (player_states) has been updated.
      wait_for: single_player_choice
      target_players:
        description: The living Doctor
        condition: player.role == 'Doctor' and player.is_alive == true
    next_phase:
      id: 13
      name: Night — Detective Investigates
  13:
    name: Night — Detective Investigates
    description: The living Detective privately selects one player to investigate
      to learn if they are a werewolf.
    actions:
    - description: Show phase indicator for Detective's turn and brief instruction
      tools:
      - createPhaseIndicator
      - createTextDisplay
    - description: Create private voting panel for the Detective to select an investigation
        target from all living players
      tools:
      - createVotingPanel
    completion_criteria:
      type: player_action
      description: Detective's investigation choice has been received via the voting
        panel, and relevant player state (player_states) has been updated.
      wait_for: single_player_choice
      target_players:
        description: The living Detective
        condition: player.role == 'Detective' and player.is_alive == true
    next_phase:
      id: 14
      name: Night — Detective Receives Result
  14:
    name: Night — Detective Receives Result
    description: Privately reveal to the Detective whether the investigated player
      is a Werewolf.
    actions:
    - description: Maintain night theme and show a private result message to the Detective
        only
      tools:
      - createPhaseIndicator
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: The Detective's investigation result has been privately displayed.
    next_phase:
      id: 15
      name: Morning — Announce Night Results
  15:
    name: Morning — Announce Night Results
    description: Reveal whether a player was eliminated during the night (or if no
      one was eliminated). Update player status accordingly.
    actions:
    - description: Switch to morning theme, clear night UI, and show morning phase
        indicator
      tools:
      - clearCanvas
      - changeBackgroundColor
      - createPhaseIndicator
    - description: Display a summary of night events (protected/attacked outcome)
      tools:
      - createTextDisplay
    - description: If a player was eliminated, announce and mark them as dead
      tools:
      - createResultDisplay
      - markPlayerDead
    completion_criteria:
      type: UI_displayed
      description: Night results have been publicly announced and player status updated.
    next_phase:
      id: 16
      name: Day Discussion
  16:
    name: Day Discussion
    description: Open discussion among all surviving players. Use a timer to structure
      the discussion period.
    actions:
    - description: Show day discussion indicator and guidance, then start a discussion
        timer
      tools:
      - createPhaseIndicator
      - createTextDisplay
      - createTimer
    completion_criteria:
      type: timer
      description: The discussion timer has finished.
    next_phase:
      id: 17
      name: Day Voting
  17:
    name: Day Voting
    description: All surviving players vote to eliminate one player.
    actions:
    - description: Present voting instructions and the voting panel to all surviving
        players
      tools:
      - createPhaseIndicator
      - createTextDisplay
      - createVotingPanel
    completion_criteria:
      type: player_action
      description: Votes have been received from all surviving players via the voting
        panel, and relevant player state (player_states) has been updated.
      wait_for: all_players_action
      target_players:
        description: All surviving players
        condition: player.is_alive == true
    next_phase:
      id: 18
      name: Announce Day Voting Results
  18:
    name: Announce Day Voting Results
    description: Display the voting results and eliminate the selected player, if
      any.
    actions:
    - description: Clear voting UI, show result summary, and mark eliminated player
        as dead
      tools:
      - clearCanvas
      - createTextDisplay
      - createResultDisplay
      - markPlayerDead
    completion_criteria:
      type: UI_displayed
      description: Day voting results have been announced and player status updated.
    next_phase:
      id: 19
      name: Check Win Conditions (Loop)
  19:
    name: Check Win Conditions (Loop)
    description: Evaluate whether either side has already won; otherwise continue
      with the next night in the cycle.
    actions:
    - description: Display a brief status check message while win conditions are evaluated
      tools:
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Win condition evaluation finished; state prepared for routing.
    next_phase:
      If no living Werewolves remain:
        id: 98
        name: Game Over — Village Wins
      If living Werewolves are equal to or outnumber living Villagers:
        id: 99
        name: Game Over — Werewolves Win
      Otherwise, continue with the night → morning → day cycle:
        id: 11
        name: Night — Werewolves Choose Target
  98:
    name: Game Over — Village Wins
    description: The village has eliminated all werewolves. Announce the village victory.
    actions:
    - description: Clear UI and present village victory message
      tools:
      - clearCanvas
      - changeBackgroundColor
      - createResultDisplay
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Victory message displayed.
    next_phase: null
  99:
    name: Game Over — Werewolves Win
    description: Werewolves equal or outnumber the villagers. Announce the werewolf
      victory.
    actions:
    - description: Clear UI and present werewolf victory message
      tools:
      - clearCanvas
      - changeBackgroundColor
      - createResultDisplay
      - createTextDisplay
    completion_criteria:
      type: UI_displayed
      description: Victory message displayed.
    next_phase: null
